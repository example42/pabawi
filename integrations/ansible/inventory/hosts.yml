# ===========================================================================
# Pabawi Demo â€” Ansible Inventory (YAML)
# A realistic multi-tier infrastructure across production, staging, and dev
# ===========================================================================

all:
  vars:
    ansible_python_interpreter: auto_silent
    ntp_servers:
      - 0.pool.ntp.org
      - 1.pool.ntp.org
    dns_domain: acme.internal
    syslog_server: syslog.acme.internal

  children:
    # =====================================================================
    # PRODUCTION
    # =====================================================================
    production:
      vars:
        env: production
        puppet_environment: production
        dns_servers:
          - 10.100.0.2
          - 10.200.0.2
      children:
        production_webservers:
          hosts:
            web-prod-1.acme.internal:
              ansible_host: 10.100.1.10
              role: webserver
              datacenter: us-east-1
              tier: frontend
              application: nginx
              pool: blue
            web-prod-2.acme.internal:
              ansible_host: 10.100.1.11
              role: webserver
              datacenter: us-east-1
              tier: frontend
              application: nginx
              pool: green
            web-prod-3.acme.internal:
              ansible_host: 10.200.1.10
              role: webserver
              datacenter: eu-west-1
              tier: frontend
              application: nginx
              pool: blue
            web-prod-4.acme.internal:
              ansible_host: 10.200.1.11
              role: webserver
              datacenter: eu-west-1
              tier: frontend
              application: nginx
              pool: green

        production_loadbalancers:
          hosts:
            lb-prod-1.acme.internal:
              ansible_host: 10.100.1.5
              role: loadbalancer
              datacenter: us-east-1
              tier: frontend
              application: haproxy
              vip: 10.100.1.100
            lb-prod-2.acme.internal:
              ansible_host: 10.200.1.5
              role: loadbalancer
              datacenter: eu-west-1
              tier: frontend
              application: haproxy
              vip: 10.200.1.100

        production_appservers:
          hosts:
            app-rails-prod-1.acme.internal:
              ansible_host: 10.100.2.10
              role: appserver
              datacenter: us-east-1
              tier: application
              runtime: ruby
              application: rails
              app_port: 3000
            app-rails-prod-2.acme.internal:
              ansible_host: 10.100.2.11
              role: appserver
              datacenter: us-east-1
              tier: application
              runtime: ruby
              application: rails
              app_port: 3000
            app-java-prod-1.acme.internal:
              ansible_host: 10.100.2.20
              ansible_user: deploy
              role: appserver
              datacenter: us-east-1
              tier: application
              os_family: RedHat
              runtime: java
              application: spring-boot
              app_port: 8080
              jvm_heap: 4g
            app-java-prod-2.acme.internal:
              ansible_host: 10.200.2.20
              ansible_user: deploy
              role: appserver
              datacenter: eu-west-1
              tier: application
              os_family: RedHat
              runtime: java
              application: spring-boot
              app_port: 8080
              jvm_heap: 4g
            app-node-prod-1.acme.internal:
              ansible_host: 10.100.2.30
              role: appserver
              datacenter: us-east-1
              tier: application
              runtime: nodejs
              application: express
              app_port: 4000
              node_version: "20"

        production_databases:
          vars:
            ansible_user: dbadmin
            ansible_become: true
          hosts:
            db-primary-prod-1.acme.internal:
              ansible_host: 10.100.3.10
              role: database
              datacenter: us-east-1
              tier: data
              os_family: RedHat
              engine: postgresql
              pg_version: "16"
              pg_role: primary
              pg_max_connections: 500
              pg_shared_buffers: 8GB
              backup_schedule: "0 2 * * *"
            db-replica-prod-1.acme.internal:
              ansible_host: 10.100.3.11
              role: database
              datacenter: us-east-1
              tier: data
              os_family: RedHat
              engine: postgresql
              pg_version: "16"
              pg_role: replica
              pg_upstream: db-primary-prod-1.acme.internal
              pg_max_connections: 200
            db-replica-prod-2.acme.internal:
              ansible_host: 10.200.3.11
              role: database
              datacenter: eu-west-1
              tier: data
              os_family: RedHat
              engine: postgresql
              pg_version: "16"
              pg_role: replica
              pg_upstream: db-primary-prod-1.acme.internal
              pg_max_connections: 200

        production_redis:
          vars:
            ansible_user: dbadmin
          hosts:
            redis-prod-1.acme.internal:
              ansible_host: 10.100.3.20
              role: cache
              datacenter: us-east-1
              tier: data
              engine: redis
              redis_maxmemory: 4gb
              redis_role: master
            redis-prod-2.acme.internal:
              ansible_host: 10.100.3.21
              role: cache
              datacenter: us-east-1
              tier: data
              engine: redis
              redis_maxmemory: 4gb
              redis_role: replica
            redis-prod-3.acme.internal:
              ansible_host: 10.200.3.20
              role: cache
              datacenter: eu-west-1
              tier: data
              engine: redis
              redis_maxmemory: 4gb
              redis_role: replica

        production_monitoring:
          vars:
            ansible_user: monitor
          hosts:
            mon-prometheus-prod-1.acme.internal:
              ansible_host: 10.100.4.10
              role: monitoring
              datacenter: us-east-1
              tier: infrastructure
              application: prometheus
              retention_days: 90
              scrape_interval: 15s
            mon-grafana-prod-1.acme.internal:
              ansible_host: 10.100.4.11
              role: monitoring
              datacenter: us-east-1
              tier: infrastructure
              application: grafana
              grafana_port: 3000
            mon-alertmanager-prod-1.acme.internal:
              ansible_host: 10.100.4.12
              role: monitoring
              datacenter: us-east-1
              tier: infrastructure
              application: alertmanager
              slack_channel: "#ops-alerts"

        production_windows:
          vars:
            ansible_connection: winrm
            ansible_winrm_transport: ntlm
            ansible_winrm_server_cert_validation: ignore
            ansible_user: Administrator
            ansible_become: false
          hosts:
            win-ad-prod-1.acme.internal:
              ansible_host: 10.100.5.10
              role: domain_controller
              datacenter: us-east-1
              tier: infrastructure
              os_family: windows
              windows_version: "2022"
              ad_domain: acme.internal
            win-iis-prod-1.acme.internal:
              ansible_host: 10.100.5.20
              role: webserver
              datacenter: us-east-1
              tier: frontend
              os_family: windows
              windows_version: "2022"
              application: iis
              dotnet_version: "8.0"
            win-iis-prod-2.acme.internal:
              ansible_host: 10.200.5.20
              role: webserver
              datacenter: eu-west-1
              tier: frontend
              os_family: windows
              windows_version: "2022"
              application: iis
              dotnet_version: "8.0"

    # =====================================================================
    # STAGING
    # =====================================================================
    staging:
      vars:
        env: staging
        puppet_environment: staging
        ansible_user: deploy
        dns_servers:
          - 172.16.0.2
        syslog_server: syslog-stg.acme.internal
      children:
        staging_webservers:
          hosts:
            web-stg-1.acme.internal:
              ansible_host: 172.16.1.10
              role: webserver
              datacenter: us-east-1
              tier: frontend
              application: nginx
            web-stg-2.acme.internal:
              ansible_host: 172.16.1.11
              role: webserver
              datacenter: us-east-1
              tier: frontend
              application: nginx

        staging_appservers:
          hosts:
            app-rails-stg-1.acme.internal:
              ansible_host: 172.16.2.10
              role: appserver
              datacenter: us-east-1
              tier: application
              runtime: ruby
              application: rails
              app_port: 3000
            app-java-stg-1.acme.internal:
              ansible_host: 172.16.2.20
              role: appserver
              datacenter: us-east-1
              tier: application
              os_family: RedHat
              runtime: java
              application: spring-boot
              app_port: 8080
              jvm_heap: 2g

        staging_databases:
          vars:
            ansible_user: dbadmin
          hosts:
            db-primary-stg-1.acme.internal:
              ansible_host: 172.16.3.10
              role: database
              datacenter: us-east-1
              tier: data
              engine: postgresql
              pg_version: "16"
              pg_role: primary
              pg_max_connections: 100
            redis-stg-1.acme.internal:
              ansible_host: 172.16.3.20
              role: cache
              datacenter: us-east-1
              tier: data
              engine: redis
              redis_maxmemory: 1gb
              redis_role: master

        staging_monitoring:
          hosts:
            mon-stg-1.acme.internal:
              ansible_host: 172.16.4.10
              role: monitoring
              datacenter: us-east-1
              tier: infrastructure
              application: prometheus

        staging_windows:
          vars:
            ansible_connection: winrm
            ansible_winrm_transport: ntlm
            ansible_winrm_server_cert_validation: ignore
            ansible_user: Administrator
            ansible_become: false
          hosts:
            win-iis-stg-1.acme.internal:
              ansible_host: 172.16.5.20
              role: webserver
              datacenter: us-east-1
              tier: frontend
              os_family: windows
              application: iis

    # =====================================================================
    # DEVELOPMENT
    # =====================================================================
    development:
      vars:
        env: development
        puppet_environment: development
        ansible_user: vagrant
        dns_servers:
          - 192.168.10.2
      children:
        dev_workloads:
          hosts:
            dev-web-1.acme.internal:
              ansible_host: 192.168.10.10
              role: webserver
              tier: frontend
              application: nginx
            dev-app-1.acme.internal:
              ansible_host: 192.168.10.20
              role: appserver
              tier: application
              runtime: ruby
              application: rails
              app_port: 3000
            dev-db-1.acme.internal:
              ansible_host: 192.168.10.30
              role: database
              tier: data
              engine: postgresql
              pg_version: "16"
              pg_role: primary

        dev_ci:
          hosts:
            ci-jenkins-1.acme.internal:
              ansible_host: 192.168.10.50
              role: ci_controller
              tier: infrastructure
              application: jenkins
              jenkins_port: 8080
              executor_count: 0
            ci-agent-1.acme.internal:
              ansible_host: 192.168.10.51
              role: ci_agent
              tier: infrastructure
              application: jenkins-agent
              executor_count: 4
              labels:
                - docker
                - linux
                - amd64
            ci-agent-2.acme.internal:
              ansible_host: 192.168.10.52
              role: ci_agent
              tier: infrastructure
              application: jenkins-agent
              executor_count: 4
              labels:
                - docker
                - linux
                - arm64

    # =====================================================================
    # EDGE / CDN NODES
    # =====================================================================
    edge:
      vars:
        env: production
        ansible_user: deploy
        puppet_environment: production
      hosts:
        edge-nyc-1.acme.internal:
          ansible_host: 10.50.1.10
          role: cdn_cache
          pop: nyc
          tier: frontend
          application: varnish
          cache_size: 32g
        edge-lax-1.acme.internal:
          ansible_host: 10.50.2.10
          role: cdn_cache
          pop: lax
          tier: frontend
          application: varnish
          cache_size: 32g
        edge-ams-1.acme.internal:
          ansible_host: 10.50.3.10
          role: cdn_cache
          pop: ams
          tier: frontend
          application: varnish
          cache_size: 64g
        edge-sin-1.acme.internal:
          ansible_host: 10.50.4.10
          role: cdn_cache
          pop: sin
          tier: frontend
          application: varnish
          cache_size: 32g

    # =====================================================================
    # NETWORK DEVICES
    # =====================================================================
    network:
      vars:
        ansible_user: netadmin
        ansible_network_os: auto
        ansible_connection: network_cli
        ansible_become: true
        ansible_become_method: enable
      hosts:
        fw-prod-1.acme.internal:
          ansible_host: 10.100.0.1
          role: firewall
          datacenter: us-east-1
          vendor: pfsense
          tier: network
          ansible_connection: ssh
        fw-prod-2.acme.internal:
          ansible_host: 10.200.0.1
          role: firewall
          datacenter: eu-west-1
          vendor: pfsense
          tier: network
          ansible_connection: ssh
        sw-core-1.acme.internal:
          ansible_host: 10.100.0.10
          role: switch
          datacenter: us-east-1
          vendor: arista
          tier: network
          ansible_network_os: arista.eos.eos
          vlan_range: "100-199"
        sw-core-2.acme.internal:
          ansible_host: 10.200.0.10
          role: switch
          datacenter: eu-west-1
          vendor: arista
          tier: network
          ansible_network_os: arista.eos.eos
          vlan_range: "200-299"

    # =====================================================================
    # CROSS-CUTTING GROUPS (for targeting by role across environments)
    # =====================================================================
    webservers:
      children:
        production_webservers:
        staging_webservers:

    appservers:
      children:
        production_appservers:
        staging_appservers:

    databases:
      children:
        production_databases:
        staging_databases:

    redis:
      children:
        production_redis:

    monitoring:
      children:
        production_monitoring:
        staging_monitoring:

    windows:
      children:
        production_windows:
        staging_windows:

    loadbalancers:
      children:
        production_loadbalancers:

    ci:
      children:
        dev_ci:

    # Datacenter groups
    us_east_1:
      children:
        production_webservers:
        production_loadbalancers:
        production_appservers:
        production_databases:
        production_redis:
        production_monitoring:
        production_windows:
        staging:

    eu_west_1:
      hosts:
        web-prod-3.acme.internal:
        web-prod-4.acme.internal:
        lb-prod-2.acme.internal:
        app-java-prod-2.acme.internal:
        db-replica-prod-2.acme.internal:
        redis-prod-3.acme.internal:
        win-iis-prod-2.acme.internal:
        fw-prod-2.acme.internal:
        sw-core-2.acme.internal:
