# Pabawi v0.2.0 Features Guide

Version: 0.2.0

## Overview

Pabawi version 0.2.0 introduces major enhancements that transform it from a Bolt-specific interface into a general-purpose remote execution platform. This guide covers all new features including PuppetDB integration, multi-source inventory, re-execution capabilities, and expert mode enhancements.

## Table of Contents

- [What's New in v0.2.0](#whats-new-in-v020)
- [Multi-Source Inventory](#multi-source-inventory)
- [PuppetDB Integration](#puppetdb-integration)
- [Re-execution Feature](#re-execution-feature)
- [Expert Mode Enhancements](#expert-mode-enhancements)
- [Enhanced Node Detail Page](#enhanced-node-detail-page)
- [Integration Status Dashboard](#integration-status-dashboard)
- [Migration from v0.1.0](#migration-from-v010)

## What's New in v0.2.0

### Major Features

1. **PuppetDB Integration**
   - Dynamic inventory discovery from PuppetDB
   - View node facts from Puppet agent runs
   - Browse Puppet run reports with detailed metrics
   - Inspect compiled catalogs
   - Track resource events and changes

2. **Multi-Source Architecture**
   - Support for multiple inventory sources (Bolt + PuppetDB)
   - Clear source attribution for all data
   - Graceful degradation when sources are unavailable
   - Unified interface across all sources

3. **Re-execution Capabilities**
   - Re-run previous commands with one click
   - Preserve or modify execution parameters
   - Track execution history and relationships
   - Context-aware re-execution from node pages

4. **Expert Mode Enhancements**
   - View complete command lines before, during, and after execution
   - Access full stdout/stderr without truncation
   - Search through long command output
   - Syntax highlighting for commands and output

5. **Enhanced UI**
   - Tabbed node detail page for better organization
   - Integration status dashboard
   - Improved loading states and error handling
   - Consistent styling across all features

## Multi-Source Inventory

### Overview

Pabawi now supports multiple inventory sources, allowing you to view and manage nodes from both Bolt inventory files and PuppetDB. This provides a comprehensive view of your infrastructure from multiple perspectives.

### Viewing Multi-Source Inventory

1. **Navigate to Inventory Page**
   - Click **Inventory** in the main navigation
   - The page displays nodes from all configured sources

2. **Source Attribution**
   - Each node shows its source with a badge:
     - **Bolt**: Nodes from Bolt inventory.yaml
     - **PuppetDB**: Nodes discovered from PuppetDB
   - Source badges use distinct colors for easy identification

3. **Filtering by Source**
   - Use the source filter dropdown
   - Select "All Sources", "Bolt", or "PuppetDB"
   - Inventory updates to show only selected source
   - Node count updates per source

### Understanding Source Differences

**Bolt Inventory:**

- Manually configured in inventory.yaml
- Includes connection details (SSH, WinRM, etc.)
- May include nodes not managed by Puppet
- Immediately reflects inventory file changes

**PuppetDB Inventory:**

- Automatically discovered from Puppet infrastructure
- Includes all nodes with recent Puppet agent runs
- Provides additional Puppet-specific metadata
- Updates as agents check in

**Nodes in Both Sources:**

- May appear twice if in both Bolt and PuppetDB
- Each entry shows its respective source
- Can be managed through either source
- Data from both sources available on node detail page

### Multi-Source Search

The search function works across all sources:

1. **Enter search term** in the search box
2. **Results include nodes** from all enabled sources
3. **Source badges** show where each result came from
4. **Filter by source** to narrow results

### Source Status

Check source health on the Home page:

- **Connected** (green): Source is healthy and responding
- **Degraded** (yellow): Source responding but with issues
- **Unavailable** (red): Source not responding

When a source is unavailable:

- Nodes from other sources still display
- Error message explains the issue
- System continues functioning normally

## PuppetDB Integration

### Overview

PuppetDB integration provides deep visibility into your Puppet-managed infrastructure, including facts, reports, catalogs, and events. All PuppetDB data is accessible directly within Pabawi's interface.

### Prerequisites

- PuppetDB must be configured (see [PuppetDB Integration Setup Guide](./puppetdb-integration-setup.md))
- Integration status should show "Connected"
- Nodes must have recent Puppet agent runs

### Viewing Node Facts from PuppetDB

Facts provide detailed system information collected by Puppet agents.

**Accessing Facts:**

1. Navigate to a node's detail page
2. Click the **Facts** tab
3. Facts from PuppetDB load automatically
4. Source badge shows "PuppetDB"

**Facts Display:**

- **Organized by Category:**
  - System: OS, kernel, virtual
  - Hardware: Processors, memory, disks
  - Network: Interfaces, IP addresses, hostname
  - Custom: Custom facts from your modules

- **Collapsible Tree Structure:**
  - Click arrows to expand/collapse sections
  - Nested data shows relationships
  - Easy navigation through complex facts

- **Metadata:**
  - Timestamp shows when facts were last updated
  - Source attribution clearly marked
  - Refresh button to reload facts

**Example Facts:**

```
os
  â”œâ”€ family: "RedHat"
  â”œâ”€ name: "CentOS"
  â””â”€ release
      â”œâ”€ full: "7.9.2009"
      â””â”€ major: "7"

processors
  â”œâ”€ count: 4
  â””â”€ models: ["Intel(R) Xeon(R) CPU"]

memory
  â””â”€ system
      â”œâ”€ total: "16.00 GiB"
      â””â”€ available: "12.34 GiB"
```

### Viewing Puppet Reports

Reports provide detailed information about Puppet agent runs.

**Accessing Reports:**

1. Navigate to a node's detail page
2. Click the **Puppet Reports** tab
3. Recent reports display in reverse chronological order
4. Click any report to view details

**Report List View:**

Each report shows:

- **Timestamp**: When the Puppet run occurred
- **Status**: Success, Changed, or Failed
- **Environment**: Puppet environment used
- **Duration**: How long the run took
- **Resource Summary**: Number of resources changed/failed

**Report Detail View:**

Click a report to see:

1. **Summary Metrics:**
   - Total resources managed
   - Resources changed
   - Resources failed
   - Execution time breakdown

2. **Resource Events:**
   - List of all resource changes
   - Before and after values
   - Success/failure status
   - File and line number references

3. **Logs:**
   - Puppet agent log messages
   - Warnings and notices
   - Error details

4. **Failed Resources** (if any):
   - Highlighted prominently in red
   - Error messages displayed
   - Troubleshooting context provided

**Status Indicators:**

- ğŸŸ¢ **Success**: All resources applied successfully
- ğŸŸ¡ **Changed**: Resources were modified
- ğŸ”´ **Failed**: One or more resources failed
- âšª **Unchanged**: No changes needed

### Viewing Catalogs

Catalogs show the desired state configuration for a node.

**Accessing Catalogs:**

1. Navigate to a node's detail page
2. Click the **Catalog** tab
3. Latest catalog loads automatically

**Catalog Display:**

- **Resources Organized by Type:**
  - File resources
  - Service resources
  - Package resources
  - User resources
  - Custom resource types

- **Resource Details:**
  - Resource title
  - Parameters and values
  - Tags
  - Source file and line number

- **Search and Filter:**
  - Search by resource title
  - Filter by resource type
  - Quick navigation to specific resources

- **Resource Relationships:**
  - Dependencies shown
  - Notification relationships
  - Ordering information

**Example Catalog View:**

```
File (15 resources)
  â”œâ”€ /etc/nginx/nginx.conf
  â”‚   â”œâ”€ ensure: file
  â”‚   â”œâ”€ owner: root
  â”‚   â”œâ”€ mode: 0644
  â”‚   â””â”€ notify: Service[nginx]
  â””â”€ /var/log/nginx
      â”œâ”€ ensure: directory
      â””â”€ owner: nginx

Service (3 resources)
  â””â”€ nginx
      â”œâ”€ ensure: running
      â”œâ”€ enable: true
      â””â”€ require: Package[nginx]

Package (5 resources)
  â””â”€ nginx
      â””â”€ ensure: installed
```

### Viewing Events

Events track individual resource changes over time.

**Accessing Events:**

1. Navigate to a node's detail page
2. Click the **Events** tab
3. Recent events display in reverse chronological order

**Event List:**

Each event shows:

- **Timestamp**: When the event occurred
- **Resource**: Type and title
- **Property**: What changed
- **Status**: Success, failure, noop, or skipped
- **Old/New Values**: Before and after states
- **Message**: Description of the change

**Filtering Events:**

- **By Status:**
  - Success: Successful changes
  - Failure: Failed changes
  - Noop: Would-be changes (noop mode)
  - Skipped: Skipped resources

- **By Resource Type:**
  - File, Service, Package, etc.
  - Custom resource types

- **By Time Range:**
  - Last hour, day, week
  - Custom date range

**Failed Events:**

- Highlighted in red
- Error messages displayed
- Troubleshooting context provided
- Link to related report

**Example Events:**

```
[2024-01-15 10:01:15] File[/etc/nginx/nginx.conf]
  Status: Success
  Property: content
  Old: {md5}abc123
  New: {md5}def456
  Message: content changed

[2024-01-15 10:01:20] Service[nginx]
  Status: Success
  Property: ensure
  Old: stopped
  New: running
  Message: ensure changed 'stopped' to 'running'
```

### PuppetDB Query Language (PQL)

Advanced users can filter inventory using PQL:

1. **Enable PQL Filter** on inventory page
2. **Enter PQL Query:**

   ```
   nodes { certname ~ "web" }
   ```

3. **Results Update** to show matching nodes
4. **Query Validation** shows syntax errors

**Common PQL Queries:**

```
# Nodes with "web" in name
nodes { certname ~ "web" }

# Nodes in production environment
nodes { catalog_environment = "production" }

# Nodes with recent failures
nodes { latest_report_status = "failed" }

# Nodes running CentOS
nodes { facts { name = "os.name" and value = "CentOS" } }
```

### PuppetDB Best Practices

1. **Check Integration Status** regularly
2. **Review Reports** after Puppet runs
3. **Monitor Failed Events** for issues
4. **Use Catalogs** to understand desired state
5. **Filter Events** to find specific changes
6. **Combine with Bolt** for remediation

## Re-execution Feature

### Overview

The re-execution feature allows you to quickly repeat previous operations with preserved parameters. This is useful for:

- Running the same command on multiple nodes
- Retrying failed operations
- Testing changes iteratively
- Repeating routine maintenance tasks

### Re-executing from Executions Page

**Step-by-Step:**

1. **Navigate to Executions Page**
   - Click **Executions** in main navigation
   - View execution history

2. **Locate Execution to Re-run**
   - Browse or search for the execution
   - Any execution type can be re-executed:
     - Commands
     - Tasks
     - Puppet runs
     - Package installations

3. **Click Re-execute Button**
   - Button appears on each execution row
   - Icon: â†» (circular arrow)
   - Hover shows "Re-execute"

4. **Review Pre-filled Parameters**
   - Execution interface opens
   - All original parameters pre-filled:
     - Target nodes
     - Command or task name
     - All parameters
     - Configuration options

5. **Modify Parameters (Optional)**
   - Change target nodes
   - Adjust parameters
   - Update configuration
   - Or keep everything the same

6. **Execute**
   - Click execute button
   - New execution starts
   - Linked to original execution

### Re-executing from Node Detail Page

**Context-Aware Re-execution:**

1. **Navigate to Node Detail Page**
   - Click on any node in inventory
   - View node's execution history

2. **Locate Execution in History**
   - Scroll to "Execution History" section
   - Find the execution to repeat

3. **Click Re-execute Button**
   - Button appears next to each execution
   - Execution interface opens

4. **Automatic Node Selection**
   - Current node automatically selected as target
   - Original parameters pre-filled
   - Ready to execute on this specific node

5. **Execute**
   - Click execute button
   - Runs on current node
   - Preserves execution history

### Understanding Execution Relationships

**Original Execution:**

- The first time an action was executed
- Has unique execution ID
- May have multiple re-executions

**Re-execution:**

- A repeat of a previous execution
- Links back to original execution
- Tracks re-execution count

**Viewing Relationships:**

1. **On Execution Detail:**
   - Shows "Original Execution" link (if re-execution)
   - Shows "Re-executions" count and list
   - Click links to navigate between related executions

2. **In Execution History:**
   - Re-executions marked with â†» icon
   - Hover shows original execution ID
   - Count shows how many times re-executed

### Re-execution Use Cases

**Use Case 1: Retry Failed Command**

```
1. Command fails on node due to temporary issue
2. Click re-execute button
3. Run again without re-typing command
4. Verify success
```

**Use Case 2: Run on Additional Nodes**

```
1. Test command on one node
2. Click re-execute
3. Add more nodes to target list
4. Execute on all nodes
```

**Use Case 3: Iterative Testing**

```
1. Run Puppet in noop mode
2. Review proposed changes
3. Click re-execute
4. Disable noop mode
5. Apply changes
```

**Use Case 4: Routine Maintenance**

```
1. Perform maintenance task
2. Save execution for future reference
3. Next maintenance window:
4. Click re-execute
5. Run same task again
```

### Re-execution Best Practices

**Do:**

- Review pre-filled parameters before executing
- Modify parameters as needed for current situation
- Use re-execution for routine tasks
- Track execution relationships for auditing
- Test on one node before re-executing on many

**Don't:**

- Blindly re-execute without reviewing parameters
- Re-execute destructive commands without verification
- Ignore failed re-executions
- Lose track of execution relationships

### Re-execution Limitations

- Cannot re-execute while original is still running
- Some parameters may need updating (e.g., timestamps)
- Re-execution creates new execution record
- Original execution remains unchanged

## Expert Mode Enhancements

### Overview

Expert mode has been significantly enhanced in v0.2.0 to provide complete transparency into command execution. When enabled, you can see the exact commands being executed and access full, untruncated output.

### What's New in Expert Mode

**v0.1.0 Expert Mode:**

- Detailed error messages
- Stack traces
- Request IDs

**v0.2.0 Expert Mode Adds:**

- Complete command line visibility
- Full stdout/stderr without truncation
- Command line shown before, during, and after execution
- Syntax highlighting for commands
- Search functionality for long output
- Output formatting preservation
- Monospace font for technical content

### Enabling Expert Mode

**Via Web Interface:**

1. Locate the **Expert Mode** toggle in navigation bar
2. Click to enable (toggle turns green/highlighted)
3. "Expert Mode" indicator appears
4. Setting persists across browser sessions

**Via API:**

Include header in requests:

```
X-Expert-Mode: true
```

### Command Line Visibility

Expert mode shows the complete command line at every stage:

**Before Execution:**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Command to be executed:                     â”‚
â”‚                                             â”‚
â”‚ bolt command run 'systemctl status nginx' \ â”‚
â”‚   --targets web-01 \                        â”‚
â”‚   --format json \                           â”‚
â”‚   --no-color                                â”‚
â”‚                                             â”‚
â”‚ [Copy Command]                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**During Execution:**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Executing:                                  â”‚
â”‚ bolt command run 'systemctl status nginx'   â”‚
â”‚                                             â”‚
â”‚ Status: Running | Elapsed: 5.3s             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Output:                                     â”‚
â”‚ â— nginx.service - nginx                     â”‚
â”‚    Loaded: loaded (/usr/lib/systemd/...)    â”‚
â”‚    Active: active (running)                 â”‚
â”‚ â–¼ [Streaming...]                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**After Execution:**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Executed Command:                           â”‚
â”‚ bolt command run 'systemctl status nginx' \ â”‚
â”‚   --targets web-01 --format json            â”‚
â”‚                                             â”‚
â”‚ Status: Success | Duration: 5.3s            â”‚
â”‚ Exit Code: 0                                â”‚
â”‚                                             â”‚
â”‚ [Copy Command] [Re-execute]                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Complete Output Display

**Full stdout/stderr:**

- No truncation or summarization
- All output preserved exactly as received
- Line breaks and formatting maintained
- Special characters displayed correctly
- ANSI color codes converted to HTML

**Output Sections:**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Standard Output (stdout):                   â”‚
â”‚ â— nginx.service - nginx - high performance  â”‚
â”‚   web server                                â”‚
â”‚    Loaded: loaded (/usr/lib/systemd/system/ â”‚
â”‚      nginx.service; enabled; vendor preset: â”‚
â”‚      disabled)                              â”‚
â”‚    Active: active (running) since Mon       â”‚
â”‚      2024-01-15 10:00:00 UTC; 2h 30min ago  â”‚
â”‚      Docs: http://nginx.org/en/docs/        â”‚
â”‚  Main PID: 1234 (nginx)                     â”‚
â”‚    CGroup: /system.slice/nginx.service      â”‚
â”‚            â”œâ”€1234 nginx: master process     â”‚
â”‚            â””â”€1235 nginx: worker process     â”‚
â”‚                                             â”‚
â”‚ Jan 15 10:00:00 web-01 systemd[1]:          â”‚
â”‚   Starting nginx...                         â”‚
â”‚ Jan 15 10:00:00 web-01 systemd[1]:          â”‚
â”‚   Started nginx.                            â”‚
â”‚                                             â”‚
â”‚ [1,234 lines] [Scroll to top] [Search]      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Standard Error (stderr):                    â”‚
â”‚ (empty)                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Search Functionality

For long output, expert mode provides search:

1. **Click Search Button** or press Ctrl+F
2. **Enter Search Term**
3. **Matches Highlighted** in yellow
4. **Navigate Between Matches:**
   - Next: â†“ or Enter
   - Previous: â†‘ or Shift+Enter
5. **Match Counter** shows "3 of 15 matches"

**Search Features:**

- Case-insensitive by default
- Option for case-sensitive search
- Regular expression support
- Highlights all matches
- Scrolls to current match
- Keyboard navigation

### Syntax Highlighting

Commands and output use syntax highlighting:

**Command Highlighting:**

```bash
bolt command run 'systemctl status nginx' \
  --targets web-01 \
  --format json \
  --no-color
```

- Commands: blue
- Strings: green
- Flags: purple
- Values: orange

**Output Highlighting:**

- Error messages: red
- Warnings: yellow
- Success messages: green
- Timestamps: gray
- File paths: blue

### Execution History with Expert Mode

**In Executions Page:**

- Command line shown for each execution
- Expandable to see full command
- Copy button for easy reuse
- Syntax highlighting applied

**In Node Detail Page:**

- Execution history shows commands
- Full output available on click
- Expert mode details preserved
- Historical commands searchable

### Expert Mode vs. Normal Mode

**Normal Mode Display:**

```
Command: systemctl status nginx
Status: Success
Output: â— nginx.service - nginx
   Active: active (running)
```

**Expert Mode Display:**

```
Command Line:
bolt command run 'systemctl status nginx' \
  --targets web-01 \
  --format json \
  --no-color

Status: Success
Exit Code: 0
Duration: 5.3s

Standard Output (1,234 lines):
â— nginx.service - nginx - high performance web server
   Loaded: loaded (/usr/lib/systemd/system/nginx.service; enabled)
   Active: active (running) since Mon 2024-01-15 10:00:00 UTC
   [... full output ...]

Standard Error:
(empty)

Request ID: req-abc123-def456
Timestamp: 2024-01-15T10:00:05.123Z
```

### Expert Mode Best Practices

**When to Enable:**

- Troubleshooting execution issues
- Learning how Pabawi constructs commands
- Debugging Bolt CLI problems
- Verifying exact commands executed
- Analyzing detailed output
- Reporting bugs or issues

**When to Disable:**

- Normal day-to-day operations
- Working with less technical users
- Simplified interface preferred
- Output is overwhelming

**Security Considerations:**

- Expert mode may expose sensitive information
- Command lines may contain credentials (avoid this!)
- Output may contain system details
- Only enable for trusted users in production
- Review output before sharing

### Troubleshooting with Expert Mode

**Scenario 1: Command Not Working**

1. Enable expert mode
2. Execute command
3. Copy exact command line
4. Test in terminal manually
5. Compare results
6. Identify differences

**Scenario 2: Unexpected Output**

1. Enable expert mode
2. View complete output
3. Search for error messages
4. Check stderr for warnings
5. Review full context
6. Identify root cause

**Scenario 3: Performance Issues**

1. Enable expert mode
2. Check command construction
3. Review execution duration
4. Analyze output size
5. Identify bottlenecks

## Enhanced Node Detail Page

### Overview

The node detail page has been completely redesigned with a tabbed interface to organize information from multiple sources and provide better navigation.

### New Tabbed Interface

**Available Tabs:**

1. **Overview**: Summary information from all sources
2. **Facts**: System facts from Bolt and PuppetDB
3. **Execution History**: Past operations on this node
4. **Puppet Reports**: Puppet run reports (PuppetDB)
5. **Catalog**: Compiled Puppet catalog (PuppetDB)
6. **Events**: Resource events (PuppetDB)

### Tab Navigation

**Switching Tabs:**

- Click tab name to switch
- Active tab highlighted
- URL updates with tab name
- Browser back/forward works
- Tab selection persists in history

**Lazy Loading:**

- Data loads only when tab activated
- Reduces initial page load time
- Loading indicator shows progress
- Cached after first load
- Refresh button to reload data

**Example URL:**

```
http://localhost:3000/nodes/web-01?tab=reports
```

### Overview Tab

**Displays:**

- Node name and URI
- Transport type
- Source attribution
- Connection status
- Quick stats from all sources:
  - Last Puppet run (PuppetDB)
  - Last execution (Bolt)
  - Fact count
  - Recent report status

**Quick Actions:**

- Gather facts
- Execute command
- Run task
- Run Puppet
- Install package

### Facts Tab

**Features:**

- Facts from all sources
- Source badges (Bolt/PuppetDB)
- Collapsible tree structure
- Search functionality
- Category organization
- Timestamp display
- Refresh button

**Comparison View:**

When facts available from multiple sources:

- Side-by-side comparison
- Differences highlighted
- Source timestamps shown
- Choose which to display

### Execution History Tab

**Displays:**

- All executions on this node
- Chronological order (newest first)
- Execution type and status
- Duration and timestamp
- Re-execute buttons
- Filter by type and status

**Features:**

- Click execution to view details
- Re-execute from history
- Filter by success/failure
- Search by command/task
- Export history

### Puppet Reports Tab

**Features:**

- List of recent Puppet runs
- Status indicators
- Resource change summary
- Click to view full report
- Filter by status
- Date range selection

**Report Details:**

- Metrics and timing
- Resource events
- Logs and messages
- Failed resources highlighted
- Link to related catalog

### Catalog Tab

**Features:**

- Resources organized by type
- Collapsible sections
- Search by resource title
- Filter by resource type
- Resource details on click
- Relationship visualization

**Resource Details:**

- Parameters and values
- Tags
- Source file and line
- Dependencies
- Notifications

### Events Tab

**Features:**

- Chronological event list
- Status indicators
- Resource information
- Old/new values
- Filter by status and type
- Date range selection
- Failed events highlighted

### Source Attribution

Every data section clearly shows its source:

**Source Badges:**

- ğŸ”µ **Bolt**: Data from Bolt inventory/execution
- ğŸŸ¢ **PuppetDB**: Data from PuppetDB
- ğŸŸ¡ **Multiple**: Data from multiple sources

**Source Indicators:**

- Displayed prominently
- Consistent across all tabs
- Color-coded for quick identification
- Hover for source details

### Independent Section Loading

**Benefits:**

- Faster initial page load
- One source failure doesn't block others
- Better user experience
- Clear error messages per section

**Loading States:**

- Skeleton screens while loading
- Progress indicators
- Error messages if source unavailable
- Retry buttons for failed sections

**Example:**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Facts (PuppetDB) âœ“ Loaded                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [Facts display...]                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Reports (PuppetDB) âš  Connection Failed      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Unable to load reports from PuppetDB        â”‚
â”‚ [Retry]                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Execution History (Bolt) âœ“ Loaded           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [Execution history display...]              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Responsive Design

**Desktop:**

- Full tabbed interface
- Side-by-side comparisons
- Detailed information visible

**Tablet:**

- Tabs stack vertically
- Optimized for touch
- Scrollable content

**Mobile:**

- Simplified tab navigation
- Essential information prioritized
- Touch-friendly controls

## Integration Status Dashboard

### Overview

The home page now includes an integration status dashboard that provides at-a-glance visibility into the health of all configured integrations.

### Accessing Integration Status

1. **Navigate to Home Page**
   - Click **Home** in main navigation
   - Integration status appears at top

2. **Status Cards**
   - One card per integration
   - Color-coded status indicators
   - Last check timestamp
   - Error details (if any)

### Status Indicators

**Connected (Green):**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âœ“ Bolt                              â”‚
â”‚ Status: Connected                   â”‚
â”‚ Type: Execution Tool & Info Source  â”‚
â”‚ Last Check: 2 minutes ago           â”‚
â”‚ Nodes: 25                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Disconnected (Red):**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âœ— PuppetDB                          â”‚
â”‚ Status: Disconnected                â”‚
â”‚ Type: Information Source            â”‚
â”‚ Last Check: 5 minutes ago           â”‚
â”‚ Error: Connection timeout           â”‚
â”‚ [Retry]                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Degraded (Yellow):**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âš  PuppetDB                          â”‚
â”‚ Status: Degraded                    â”‚
â”‚ Type: Information Source            â”‚
â”‚ Last Check: 1 minute ago            â”‚
â”‚ Warning: Slow response times        â”‚
â”‚ Nodes: 42                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Integration Types

**Execution Tool:**

- Can execute actions (commands, tasks)
- Example: Bolt

**Information Source:**

- Provides node data (inventory, facts)
- Example: PuppetDB

**Both:**

- Provides both capabilities
- Example: Bolt (execution + inventory)

### Summary Statistics

**Aggregated Metrics:**

- Total nodes across all sources
- Recent executions count
- Success rate percentage
- Active integrations count

**Example:**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Infrastructure Summary                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Total Nodes: 67 (Bolt: 25, PuppetDB: 42)   â”‚
â”‚ Recent Executions: 156                      â”‚
â”‚ Success Rate: 94.2%                         â”‚
â”‚ Active Integrations: 2 of 2                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Refresh Integration Status

**Manual Refresh:**

1. Click **Refresh** button on status card
2. Or click **Refresh All** for all integrations
3. Status updates immediately
4. Timestamp shows last check time

**Automatic Refresh:**

- Status checks every 60 seconds
- Updates automatically in background
- No page reload required
- Visual indicator during refresh

### Troubleshooting Integration Issues

**When Integration Shows Disconnected:**

1. **Check Configuration:**
   - Verify environment variables
   - Check configuration file
   - Ensure service is enabled

2. **Test Connectivity:**
   - Ping integration server
   - Check firewall rules
   - Verify network access

3. **Review Logs:**
   - Check Pabawi logs
   - Look for error messages
   - Enable debug logging

4. **Click Retry:**
   - Attempts reconnection
   - Shows updated status
   - Displays new error if still failing

**Common Issues:**

- **Connection Timeout**: Network or firewall issue
- **Authentication Failed**: Invalid credentials
- **Service Unavailable**: Integration server down
- **Configuration Error**: Invalid configuration

### Integration Health Monitoring

**Best Practices:**

1. **Check Status Regularly:**
   - Review dashboard daily
   - Monitor for degraded status
   - Address issues promptly

2. **Set Up Alerts:**
   - Configure monitoring tools
   - Alert on status changes
   - Track uptime metrics

3. **Review Error Messages:**
   - Read error details carefully
   - Follow troubleshooting steps
   - Document recurring issues

4. **Test After Changes:**
   - Verify status after configuration changes
   - Test connectivity after network changes
   - Confirm after integration updates

## Migration from v0.1.0

### Overview

Upgrading from v0.1.0 to v0.2.0 is straightforward. The new version is backward compatible with v0.1.0 configurations and data.

### What's Preserved

**Existing Functionality:**

- All v0.1.0 features continue to work
- Bolt integration unchanged
- Existing inventory still works
- Command execution unchanged
- Task execution unchanged
- Execution history preserved

**Data Migration:**

- Execution history automatically migrated
- Database schema updated automatically
- No manual data migration required
- Existing executions remain accessible

### Configuration Changes

**Required Changes:**

None! v0.2.0 works with existing v0.1.0 configuration.

**Optional Changes:**

To enable new features, add:

```bash
# Enable PuppetDB integration
PUPPETDB_ENABLED=true
PUPPETDB_SERVER_URL=https://puppetdb.example.com
PUPPETDB_PORT=8081

# Optional: Configure PuppetDB authentication
PUPPETDB_TOKEN=your-token-here

# Optional: Configure SSL
PUPPETDB_SSL_ENABLED=true
PUPPETDB_SSL_CA=/path/to/ca.pem
```

### Database Migration

**Automatic Migration:**

1. **Backup Database** (recommended):

   ```bash
   cp backend/data/executions.db backend/data/executions.db.backup
   ```

2. **Start Pabawi:**

   ```bash
   npm run dev:backend
   ```

3. **Migration Runs Automatically:**
   - New columns added to executions table
   - Existing data preserved
   - No downtime required

**New Database Fields:**

- `stdout`: Complete stdout output
- `stderr`: Complete stderr output
- `originalExecutionId`: Link to original execution
- `reExecutionCount`: Number of re-executions

**Rollback (if needed):**

```bash
# Stop Pabawi
# Restore backup
cp backend/data/executions.db.backup backend/data/executions.db
# Restart with v0.1.0
```

### UI Changes

**What's Different:**

1. **Navigation:**
   - Same navigation structure
   - New integration status on home page
   - Enhanced node detail page with tabs

2. **Inventory Page:**
   - Source badges added
   - Source filter added
   - Multi-source support
   - Otherwise unchanged

3. **Node Detail Page:**
   - Now uses tabs
   - More organized layout
   - New PuppetDB tabs (if configured)
   - Existing functionality in appropriate tabs

4. **Executions Page:**
   - Re-execute buttons added
   - Otherwise unchanged

5. **Expert Mode:**
   - Enhanced with command line display
   - Full output visibility
   - Search functionality
   - Otherwise same toggle

### Feature Adoption

**Gradual Adoption:**

You can adopt new features gradually:

1. **Start with v0.2.0:**
   - Use existing Bolt functionality
   - No configuration changes needed
   - Explore new UI enhancements

2. **Enable PuppetDB:**
   - Configure PuppetDB when ready
   - Test with a few nodes first
   - Gradually expand usage

3. **Use Re-execution:**
   - Available immediately
   - No configuration needed
   - Start using when convenient

4. **Explore Expert Mode:**
   - Enable when troubleshooting
   - Learn command construction
   - Use for debugging

### Testing the Upgrade

**Verification Steps:**

1. **Check Existing Functionality:**

   ```bash
   # Test inventory
   curl http://localhost:3000/api/inventory
   
   # Test command execution
   curl -X POST http://localhost:3000/api/nodes/node1/command \
     -H "Content-Type: application/json" \
     -d '{"command": "uptime"}'
   
   # Test execution history
   curl http://localhost:3000/api/executions
   ```

2. **Verify Database Migration:**

   ```bash
   # Check database schema
   sqlite3 backend/data/executions.db ".schema executions"
   
   # Should show new columns: stdout, stderr, originalExecutionId, reExecutionCount
   ```

3. **Test New Features:**

   ```bash
   # Test integration status
   curl http://localhost:3000/api/integrations/status
   
   # Test re-execution
   curl -X POST http://localhost:3000/api/executions/exec-123/re-execute
   
   # Test PuppetDB (if configured)
   curl http://localhost:3000/api/integrations/puppetdb/nodes
   ```

4. **Verify UI:**
   - Open browser to `http://localhost:3000`
   - Check home page shows integration status
   - Navigate to inventory (should show source badges)
   - Open node detail page (should show tabs)
   - Check executions page (should show re-execute buttons)

### Troubleshooting Upgrade Issues

**Issue: Database Migration Failed**

```bash
# Check logs for migration errors
npm run dev:backend

# Look for:
[ERROR] Database migration failed: ...

# Solution: Restore backup and retry
cp backend/data/executions.db.backup backend/data/executions.db
npm run dev:backend
```

**Issue: PuppetDB Not Connecting**

```bash
# Verify configuration
printenv | grep PUPPETDB

# Test PuppetDB directly
curl https://puppetdb.example.com:8081/pdb/meta/v1/version

# Check Pabawi logs
npm run dev:backend
# Look for PuppetDB connection errors
```

**Issue: UI Not Loading**

```bash
# Clear browser cache
# Hard refresh: Ctrl+Shift+R (or Cmd+Shift+R on Mac)

# Rebuild frontend
cd frontend
npm run build
cd ..

# Restart backend
npm run dev:backend
```

**Issue: Re-execution Not Working**

```bash
# Check execution exists
curl http://localhost:3000/api/executions/exec-123

# Check database has new columns
sqlite3 backend/data/executions.db \
  "PRAGMA table_info(executions);"

# Should show originalExecutionId and reExecutionCount
```

### Getting Help

**Resources:**

- [PuppetDB Integration Setup Guide](./puppetdb-integration-setup.md)
- [Configuration Guide](./configuration.md)
- [API Documentation](./puppetdb-api.md)
- [Troubleshooting Guide](./troubleshooting.md)

**Support:**

1. Check documentation
2. Review logs with `LOG_LEVEL=debug`
3. Enable expert mode for detailed errors
4. Contact your administrator
5. Report issues with:
   - Version information
   - Configuration (sanitized)
   - Error messages
   - Steps to reproduce

## Conclusion

Pabawi v0.2.0 brings powerful new capabilities while maintaining full backward compatibility with v0.1.0. The multi-source architecture, PuppetDB integration, re-execution features, and expert mode enhancements provide a comprehensive platform for infrastructure management.

**Key Takeaways:**

1. **Multi-Source Support**: View infrastructure from multiple perspectives
2. **PuppetDB Integration**: Deep visibility into Puppet-managed nodes
3. **Re-execution**: Quickly repeat operations with preserved parameters
4. **Expert Mode**: Complete transparency into command execution
5. **Enhanced UI**: Better organization and navigation
6. **Backward Compatible**: Seamless upgrade from v0.1.0

**Next Steps:**

1. Review the [PuppetDB Integration Setup Guide](./puppetdb-integration-setup.md)
2. Configure PuppetDB integration (if desired)
3. Explore the new tabbed node detail page
4. Try re-executing previous operations
5. Enable expert mode for troubleshooting
6. Provide feedback on new features

Happy automating with Pabawi v0.2.0!
